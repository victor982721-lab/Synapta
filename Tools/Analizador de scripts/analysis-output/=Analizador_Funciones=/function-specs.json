[
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:35.9354981Z",
    "Nombre": "Remove-EmptyNodes",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Remove-EmptyNodes",
    "Comandos": "Remove-EmptyNodes",
    "Returns": [
      "$acc",
      "$Node",
      "$null",
      "$result"
    ],
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": {
                "Type": "VariableExpressionAst"
              }
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [string]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "IfStatementAst",
                        "Condition": "$Node.Trim().Length -eq 0",
                        "Children": [
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "BinaryExpressionAst",
                                "Children": [
                                  {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "InvokeMemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  },
                                  {
                                    "Type": "ConstantExpressionAst"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": {
                              "Type": "ReturnStatementAst",
                              "Return": "$null",
                              "Children": {
                                "Type": "PipelineAst",
                                "Children": {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              }
                            }
                          }
                        ]
                      },
                      {
                        "Type": "ReturnStatementAst",
                        "Return": "$Node",
                        "Children": {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "VariableExpressionAst"
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Collections.IDictionary]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "AssignmentStatementAst",
                        "Assignment": "$result = [ordered]@{}",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "ConvertExpressionAst",
                              "Children": [
                                {
                                  "Type": "TypeConstraintAst"
                                },
                                {
                                  "Type": "HashtableAst"
                                }
                              ]
                            }
                          }
                        ]
                      },
                      {
                        "Type": "ForEachStatementAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "MemberExpressionAst",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": [
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$cleaned = Remove-EmptyNodes $Node[$k]",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandAst",
                                      "Command": "Remove-EmptyNodes $Node[$k]",
                                      "Children": [
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        },
                                        {
                                          "Type": "IndexExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "VariableExpressionAst"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "IfStatementAst",
                                "Condition": "$cleaned -ne $null",
                                "Children": [
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandExpressionAst",
                                      "Children": {
                                        "Type": "BinaryExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "VariableExpressionAst"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  {
                                    "Type": "StatementBlockAst",
                                    "Children": {
                                      "Type": "IfStatementAst",
                                      "Condition": "$cleaned -isnot [System.Collections.IEnumerable] -or $cleaned -is [string]",
                                      "Children": [
                                        {
                                          "Type": "PipelineAst",
                                          "Children": {
                                            "Type": "CommandExpressionAst",
                                            "Children": {
                                              "Type": "BinaryExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "BinaryExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "TypeExpressionAst"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "Type": "BinaryExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "TypeExpressionAst"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          }
                                        },
                                        {
                                          "Type": "StatementBlockAst",
                                          "Children": {
                                            "Type": "AssignmentStatementAst",
                                            "Assignment": "$result[$k] = $cleaned",
                                            "Children": [
                                              {
                                                "Type": "IndexExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "VariableExpressionAst"
                                                  },
                                                  {
                                                    "Type": "VariableExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "CommandExpressionAst",
                                                "Children": {
                                                  "Type": "VariableExpressionAst"
                                                }
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "Type": "StatementBlockAst",
                                          "Children": [
                                            {
                                              "Type": "AssignmentStatementAst",
                                              "Assignment": "$enum = $cleaned.GetEnumerator()",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "CommandExpressionAst",
                                                  "Children": {
                                                    "Type": "InvokeMemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "IfStatementAst",
                                              "Condition": "$enum.MoveNext()",
                                              "Children": [
                                                {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "InvokeMemberExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "VariableExpressionAst"
                                                        },
                                                        {
                                                          "Type": "StringConstantExpressionAst"
                                                        }
                                                      ]
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": {
                                                    "Type": "AssignmentStatementAst",
                                                    "Assignment": "$result[$k] = $cleaned",
                                                    "Children": [
                                                      {
                                                        "Type": "IndexExpressionAst",
                                                        "Children": [
                                                          {
                                                            "Type": "VariableExpressionAst"
                                                          },
                                                          {
                                                            "Type": "VariableExpressionAst"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "Type": "CommandExpressionAst",
                                                        "Children": {
                                                          "Type": "VariableExpressionAst"
                                                        }
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "Type": "IfStatementAst",
                        "Condition": "$result.Count -eq 0",
                        "Children": [
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "BinaryExpressionAst",
                                "Children": [
                                  {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "VariableExpressionAst"
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  },
                                  {
                                    "Type": "ConstantExpressionAst"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": {
                              "Type": "ReturnStatementAst",
                              "Return": "$null",
                              "Children": {
                                "Type": "PipelineAst",
                                "Children": {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              }
                            }
                          }
                        ]
                      },
                      {
                        "Type": "ReturnStatementAst",
                        "Return": "$result",
                        "Children": {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "VariableExpressionAst"
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Collections.IEnumerable] -and $Node -isnot [string]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "BinaryExpressionAst",
                            "Children": [
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "TypeExpressionAst"
                              }
                            ]
                          },
                          {
                            "Type": "BinaryExpressionAst",
                            "Children": [
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "TypeExpressionAst"
                              }
                            ]
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "AssignmentStatementAst",
                        "Assignment": "$acc = @()",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "ArrayExpressionAst",
                              "Children": {
                                "Type": "StatementBlockAst"
                              }
                            }
                          }
                        ]
                      },
                      {
                        "Type": "ForEachStatementAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "VariableExpressionAst"
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": [
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$cleaned = Remove-EmptyNodes $item",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandAst",
                                      "Command": "Remove-EmptyNodes $item",
                                      "Children": [
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        },
                                        {
                                          "Type": "VariableExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "IfStatementAst",
                                "Condition": "$cleaned -ne $null",
                                "Children": [
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandExpressionAst",
                                      "Children": {
                                        "Type": "BinaryExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "VariableExpressionAst"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  {
                                    "Type": "StatementBlockAst",
                                    "Children": {
                                      "Type": "IfStatementAst",
                                      "Condition": "$cleaned -isnot [System.Collections.IEnumerable] -or $cleaned -is [string]",
                                      "Children": [
                                        {
                                          "Type": "PipelineAst",
                                          "Children": {
                                            "Type": "CommandExpressionAst",
                                            "Children": {
                                              "Type": "BinaryExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "BinaryExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "TypeExpressionAst"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "Type": "BinaryExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "TypeExpressionAst"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          }
                                        },
                                        {
                                          "Type": "StatementBlockAst",
                                          "Children": {
                                            "Type": "AssignmentStatementAst",
                                            "Assignment": "$acc = $cleaned",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "CommandExpressionAst",
                                                "Children": {
                                                  "Type": "VariableExpressionAst"
                                                }
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "Type": "StatementBlockAst",
                                          "Children": [
                                            {
                                              "Type": "AssignmentStatementAst",
                                              "Assignment": "$enu = $cleaned.GetEnumerator()",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "CommandExpressionAst",
                                                  "Children": {
                                                    "Type": "InvokeMemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "IfStatementAst",
                                              "Condition": "$enu.MoveNext()",
                                              "Children": [
                                                {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "InvokeMemberExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "VariableExpressionAst"
                                                        },
                                                        {
                                                          "Type": "StringConstantExpressionAst"
                                                        }
                                                      ]
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": {
                                                    "Type": "AssignmentStatementAst",
                                                    "Assignment": "$acc = $cleaned",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "CommandExpressionAst",
                                                        "Children": {
                                                          "Type": "VariableExpressionAst"
                                                        }
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "Type": "IfStatementAst",
                        "Condition": "$acc.Count -eq 0",
                        "Children": [
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "BinaryExpressionAst",
                                "Children": [
                                  {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "VariableExpressionAst"
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  },
                                  {
                                    "Type": "ConstantExpressionAst"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": {
                              "Type": "ReturnStatementAst",
                              "Return": "$null",
                              "Children": {
                                "Type": "PipelineAst",
                                "Children": {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              }
                            }
                          }
                        ]
                      },
                      {
                        "Type": "ReturnStatementAst",
                        "Return": "$acc",
                        "Children": {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "VariableExpressionAst"
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$Node",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  }
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:37.2027194Z",
    "Nombre": "Extract-Commands",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Extract-Commands",
    "Comandos": [
      "ForEach-Object",
      "Select-Object",
      "Sort-Object"
    ],
    "Returns": "$cmds | Sort-Object -Unique",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$cmds = @()",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ArrayExpressionAst",
                      "Children": {
                        "Type": "StatementBlockAst"
                      }
                    }
                  }
                ]
              },
              {
                "Type": "PipelineAst",
                "Children": [
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "InvokeMemberExpressionAst",
                      "Children": [
                        {
                          "Type": "MemberExpressionAst",
                          "Children": [
                            {
                              "Type": "VariableExpressionAst"
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            }
                          ]
                        },
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "ScriptBlockExpressionAst",
                          "Children": {
                            "Type": "ScriptBlockAst",
                            "Children": [
                              {
                                "Type": "ParamBlockAst",
                                "Children": {
                                  "Type": "ParameterAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              },
                              {
                                "Type": "NamedBlockAst",
                                "Children": {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "TypeExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                }
                              }
                            ]
                          }
                        },
                        {
                          "Type": "VariableExpressionAst"
                        }
                      ]
                    }
                  },
                  {
                    "Type": "CommandAst",
                    "Command": "ForEach-Object {\n        $first = $_.CommandElements | Select-Object -First 1\n        if ($first -and $first.Value) { $cmds += $first.Value }\n    }",
                    "Children": [
                      {
                        "Type": "StringConstantExpressionAst"
                      },
                      {
                        "Type": "ScriptBlockExpressionAst",
                        "Children": {
                          "Type": "ScriptBlockAst",
                          "Children": {
                            "Type": "NamedBlockAst",
                            "Children": [
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$first = $_.CommandElements | Select-Object -First 1",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "PipelineAst",
                                    "Children": [
                                      {
                                        "Type": "CommandExpressionAst",
                                        "Children": {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      },
                                      {
                                        "Type": "CommandAst",
                                        "Command": "Select-Object -First 1",
                                        "Children": [
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          },
                                          {
                                            "Type": "CommandParameterAst"
                                          },
                                          {
                                            "Type": "ConstantExpressionAst"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "Type": "IfStatementAst",
                                "Condition": "$first -and $first.Value",
                                "Children": [
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandExpressionAst",
                                      "Children": {
                                        "Type": "BinaryExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  {
                                    "Type": "StatementBlockAst",
                                    "Children": {
                                      "Type": "AssignmentStatementAst",
                                      "Assignment": "$cmds = $first.Value",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$cmds | Sort-Object -Unique",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": [
                    {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "VariableExpressionAst"
                      }
                    },
                    {
                      "Type": "CommandAst",
                      "Command": "Sort-Object -Unique",
                      "Children": [
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "CommandParameterAst"
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:37.4785886Z",
    "Nombre": "Extract-TryCatch",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Extract-TryCatch",
    "Comandos": "ForEach-Object",
    "Returns": "$res",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$res = @()",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ArrayExpressionAst",
                      "Children": {
                        "Type": "StatementBlockAst"
                      }
                    }
                  }
                ]
              },
              {
                "Type": "PipelineAst",
                "Children": [
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "InvokeMemberExpressionAst",
                      "Children": [
                        {
                          "Type": "MemberExpressionAst",
                          "Children": [
                            {
                              "Type": "VariableExpressionAst"
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            }
                          ]
                        },
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "ScriptBlockExpressionAst",
                          "Children": {
                            "Type": "ScriptBlockAst",
                            "Children": [
                              {
                                "Type": "ParamBlockAst",
                                "Children": {
                                  "Type": "ParameterAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              },
                              {
                                "Type": "NamedBlockAst",
                                "Children": {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "TypeExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                }
                              }
                            ]
                          }
                        },
                        {
                          "Type": "VariableExpressionAst"
                        }
                      ]
                    }
                  },
                  {
                    "Type": "CommandAst",
                    "Command": "ForEach-Object {\n        $tryText = $null\n        if ($_.Body -and $_.Body.Extent -and $_.Body.Extent.Text) {\n            $tryText = ($_.Body.Extent.Text.Trim() -replace \"`r\",\"\") -replace \"`n\", \"\\n\"\n        }\n\n        $types = @()\n        $blocks = @()\n        if ($_.CatchClauses) {\n            foreach ($cc in $_.CatchClauses) {\n                if ($cc.ExceptionTypes) {\n                    foreach ($et in $cc.ExceptionTypes) {\n                        if ($et.Extent -and $et.Extent.Text) {\n                            $types += $et.Extent.Text.Trim()\n                        }\n                    }\n                }\n                if ($cc.Action -and $cc.Action.Extent -and $cc.Action.Extent.Text) {\n                    $bl = ($cc.Action.Extent.Text.Trim() -replace \"`r\",\"\") -replace \"`n\", \"\\n\"\n                    $blocks += $bl\n                }\n            }\n        }\n\n        $res += [ordered]@{\n            TryBlock   = $tryText\n            CatchTypes = $types\n            CatchBlock = if ($blocks.Count -eq 1) { $blocks[0] } else { ($blocks -join \"\\n\\n\") }\n        }\n    }",
                    "Children": [
                      {
                        "Type": "StringConstantExpressionAst"
                      },
                      {
                        "Type": "ScriptBlockExpressionAst",
                        "Children": {
                          "Type": "ScriptBlockAst",
                          "Children": {
                            "Type": "NamedBlockAst",
                            "Children": [
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$tryText = $null",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "VariableExpressionAst"
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "IfStatementAst",
                                "Condition": "$_.Body -and $_.Body.Extent -and $_.Body.Extent.Text",
                                "Children": [
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandExpressionAst",
                                      "Children": {
                                        "Type": "BinaryExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "BinaryExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "VariableExpressionAst"
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "MemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "MemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  {
                                    "Type": "StatementBlockAst",
                                    "Children": {
                                      "Type": "AssignmentStatementAst",
                                      "Assignment": "$tryText = ($_.Body.Extent.Text.Trim() -replace \"`r\",\"\") -replace \"`n\", \"\\n\"",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "BinaryExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "ParenExpressionAst",
                                                "Children": {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "BinaryExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "InvokeMemberExpressionAst",
                                                          "Children": [
                                                            {
                                                              "Type": "MemberExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "MemberExpressionAst",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "MemberExpressionAst",
                                                                      "Children": [
                                                                        {
                                                                          "Type": "VariableExpressionAst"
                                                                        },
                                                                        {
                                                                          "Type": "StringConstantExpressionAst"
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "Type": "StringConstantExpressionAst"
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "Type": "StringConstantExpressionAst"
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "Type": "ArrayLiteralAst",
                                                          "Children": [
                                                            {
                                                              "Type": "StringConstantExpressionAst"
                                                            },
                                                            {
                                                              "Type": "StringConstantExpressionAst"
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  }
                                                }
                                              },
                                              {
                                                "Type": "ArrayLiteralAst",
                                                "Children": [
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$types = @()",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "ArrayExpressionAst",
                                      "Children": {
                                        "Type": "StatementBlockAst"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$blocks = @()",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "ArrayExpressionAst",
                                      "Children": {
                                        "Type": "StatementBlockAst"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "IfStatementAst",
                                "Condition": "$_.CatchClauses",
                                "Children": [
                                  {
                                    "Type": "PipelineAst",
                                    "Children": {
                                      "Type": "CommandExpressionAst",
                                      "Children": {
                                        "Type": "MemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  {
                                    "Type": "StatementBlockAst",
                                    "Children": {
                                      "Type": "ForEachStatementAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "PipelineAst",
                                          "Children": {
                                            "Type": "CommandExpressionAst",
                                            "Children": {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            }
                                          }
                                        },
                                        {
                                          "Type": "StatementBlockAst",
                                          "Children": [
                                            {
                                              "Type": "IfStatementAst",
                                              "Condition": "$cc.ExceptionTypes",
                                              "Children": [
                                                {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "MemberExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "VariableExpressionAst"
                                                        },
                                                        {
                                                          "Type": "StringConstantExpressionAst"
                                                        }
                                                      ]
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": {
                                                    "Type": "ForEachStatementAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "PipelineAst",
                                                        "Children": {
                                                          "Type": "CommandExpressionAst",
                                                          "Children": {
                                                            "Type": "MemberExpressionAst",
                                                            "Children": [
                                                              {
                                                                "Type": "VariableExpressionAst"
                                                              },
                                                              {
                                                                "Type": "StringConstantExpressionAst"
                                                              }
                                                            ]
                                                          }
                                                        }
                                                      },
                                                      {
                                                        "Type": "StatementBlockAst",
                                                        "Children": {
                                                          "Type": "IfStatementAst",
                                                          "Condition": "$et.Extent -and $et.Extent.Text",
                                                          "Children": [
                                                            {
                                                              "Type": "PipelineAst",
                                                              "Children": {
                                                                "Type": "CommandExpressionAst",
                                                                "Children": {
                                                                  "Type": "BinaryExpressionAst",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "MemberExpressionAst",
                                                                      "Children": [
                                                                        {
                                                                          "Type": "VariableExpressionAst"
                                                                        },
                                                                        {
                                                                          "Type": "StringConstantExpressionAst"
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "Type": "MemberExpressionAst",
                                                                      "Children": [
                                                                        {
                                                                          "Type": "MemberExpressionAst",
                                                                          "Children": [
                                                                            {
                                                                              "Type": "VariableExpressionAst"
                                                                            },
                                                                            {
                                                                              "Type": "StringConstantExpressionAst"
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "Type": "StringConstantExpressionAst"
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              }
                                                            },
                                                            {
                                                              "Type": "StatementBlockAst",
                                                              "Children": {
                                                                "Type": "AssignmentStatementAst",
                                                                "Assignment": "$types = $et.Extent.Text.Trim()",
                                                                "Children": [
                                                                  {
                                                                    "Type": "VariableExpressionAst"
                                                                  },
                                                                  {
                                                                    "Type": "CommandExpressionAst",
                                                                    "Children": {
                                                                      "Type": "InvokeMemberExpressionAst",
                                                                      "Children": [
                                                                        {
                                                                          "Type": "MemberExpressionAst",
                                                                          "Children": [
                                                                            {
                                                                              "Type": "MemberExpressionAst",
                                                                              "Children": [
                                                                                {
                                                                                  "Type": "VariableExpressionAst"
                                                                                },
                                                                                {
                                                                                  "Type": "StringConstantExpressionAst"
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "Type": "StringConstantExpressionAst"
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "Type": "StringConstantExpressionAst"
                                                                        }
                                                                      ]
                                                                    }
                                                                  }
                                                                ]
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "IfStatementAst",
                                              "Condition": "$cc.Action -and $cc.Action.Extent -and $cc.Action.Extent.Text",
                                              "Children": [
                                                {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "BinaryExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "BinaryExpressionAst",
                                                          "Children": [
                                                            {
                                                              "Type": "MemberExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "VariableExpressionAst"
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "Type": "MemberExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "MemberExpressionAst",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "VariableExpressionAst"
                                                                    },
                                                                    {
                                                                      "Type": "StringConstantExpressionAst"
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "Type": "MemberExpressionAst",
                                                          "Children": [
                                                            {
                                                              "Type": "MemberExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "MemberExpressionAst",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "VariableExpressionAst"
                                                                    },
                                                                    {
                                                                      "Type": "StringConstantExpressionAst"
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "Type": "StringConstantExpressionAst"
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": [
                                                    {
                                                      "Type": "AssignmentStatementAst",
                                                      "Assignment": "$bl = ($cc.Action.Extent.Text.Trim() -replace \"`r\",\"\") -replace \"`n\", \"\\n\"",
                                                      "Children": [
                                                        {
                                                          "Type": "VariableExpressionAst"
                                                        },
                                                        {
                                                          "Type": "CommandExpressionAst",
                                                          "Children": {
                                                            "Type": "BinaryExpressionAst",
                                                            "Children": [
                                                              {
                                                                "Type": "ParenExpressionAst",
                                                                "Children": {
                                                                  "Type": "PipelineAst",
                                                                  "Children": {
                                                                    "Type": "CommandExpressionAst",
                                                                    "Children": {
                                                                      "Type": "BinaryExpressionAst",
                                                                      "Children": [
                                                                        {
                                                                          "Type": "InvokeMemberExpressionAst",
                                                                          "Children": [
                                                                            {
                                                                              "Type": "MemberExpressionAst",
                                                                              "Children": [
                                                                                {
                                                                                  "Type": "MemberExpressionAst",
                                                                                  "Children": [
                                                                                    {
                                                                                      "Type": "MemberExpressionAst",
                                                                                      "Children": [
                                                                                        {
                                                                                          "Type": "VariableExpressionAst"
                                                                                        },
                                                                                        {
                                                                                          "Type": "StringConstantExpressionAst"
                                                                                        }
                                                                                      ]
                                                                                    },
                                                                                    {
                                                                                      "Type": "StringConstantExpressionAst"
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "Type": "StringConstantExpressionAst"
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "Type": "StringConstantExpressionAst"
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "Type": "ArrayLiteralAst",
                                                                          "Children": [
                                                                            {
                                                                              "Type": "StringConstantExpressionAst"
                                                                            },
                                                                            {
                                                                              "Type": "StringConstantExpressionAst"
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  }
                                                                }
                                                              },
                                                              {
                                                                "Type": "ArrayLiteralAst",
                                                                "Children": [
                                                                  {
                                                                    "Type": "StringConstantExpressionAst"
                                                                  },
                                                                  {
                                                                    "Type": "StringConstantExpressionAst"
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "Type": "AssignmentStatementAst",
                                                      "Assignment": "$blocks = $bl",
                                                      "Children": [
                                                        {
                                                          "Type": "VariableExpressionAst"
                                                        },
                                                        {
                                                          "Type": "CommandExpressionAst",
                                                          "Children": {
                                                            "Type": "VariableExpressionAst"
                                                          }
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              {
                                "Type": "AssignmentStatementAst",
                                "Assignment": "$res = [ordered]@{\n            TryBlock   = $tryText\n            CatchTypes = $types\n            CatchBlock = if ($blocks.Count -eq 1) { $blocks[0] } else { ($blocks -join \"\\n\\n\") }\n        }",
                                "Children": [
                                  {
                                    "Type": "VariableExpressionAst"
                                  },
                                  {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "ConvertExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "TypeConstraintAst"
                                        },
                                        {
                                          "Type": "HashtableAst",
                                          "Children": [
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            },
                                            {
                                              "Type": "PipelineAst",
                                              "Children": {
                                                "Type": "CommandExpressionAst",
                                                "Children": {
                                                  "Type": "VariableExpressionAst"
                                                }
                                              }
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            },
                                            {
                                              "Type": "PipelineAst",
                                              "Children": {
                                                "Type": "CommandExpressionAst",
                                                "Children": {
                                                  "Type": "VariableExpressionAst"
                                                }
                                              }
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            },
                                            {
                                              "Type": "IfStatementAst",
                                              "Condition": "$blocks.Count -eq 1",
                                              "Children": [
                                                {
                                                  "Type": "PipelineAst",
                                                  "Children": {
                                                    "Type": "CommandExpressionAst",
                                                    "Children": {
                                                      "Type": "BinaryExpressionAst",
                                                      "Children": [
                                                        {
                                                          "Type": "MemberExpressionAst",
                                                          "Children": [
                                                            {
                                                              "Type": "VariableExpressionAst"
                                                            },
                                                            {
                                                              "Type": "StringConstantExpressionAst"
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "Type": "ConstantExpressionAst"
                                                        }
                                                      ]
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": {
                                                    "Type": "PipelineAst",
                                                    "Children": {
                                                      "Type": "CommandExpressionAst",
                                                      "Children": {
                                                        "Type": "IndexExpressionAst",
                                                        "Children": [
                                                          {
                                                            "Type": "VariableExpressionAst"
                                                          },
                                                          {
                                                            "Type": "ConstantExpressionAst"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  }
                                                },
                                                {
                                                  "Type": "StatementBlockAst",
                                                  "Children": {
                                                    "Type": "PipelineAst",
                                                    "Children": {
                                                      "Type": "CommandExpressionAst",
                                                      "Children": {
                                                        "Type": "ParenExpressionAst",
                                                        "Children": {
                                                          "Type": "PipelineAst",
                                                          "Children": {
                                                            "Type": "CommandExpressionAst",
                                                            "Children": {
                                                              "Type": "BinaryExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "VariableExpressionAst"
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$res",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  }
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:38.3719367Z",
    "Nombre": "Extract-Returns",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Extract-Returns",
    "Comandos": [
      "ForEach-Object",
      "Sort-Object"
    ],
    "Returns": "$rets | Sort-Object -Unique",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$rets = @()",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ArrayExpressionAst",
                      "Children": {
                        "Type": "StatementBlockAst"
                      }
                    }
                  }
                ]
              },
              {
                "Type": "PipelineAst",
                "Children": [
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "InvokeMemberExpressionAst",
                      "Children": [
                        {
                          "Type": "MemberExpressionAst",
                          "Children": [
                            {
                              "Type": "VariableExpressionAst"
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            }
                          ]
                        },
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "ScriptBlockExpressionAst",
                          "Children": {
                            "Type": "ScriptBlockAst",
                            "Children": [
                              {
                                "Type": "ParamBlockAst",
                                "Children": {
                                  "Type": "ParameterAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              },
                              {
                                "Type": "NamedBlockAst",
                                "Children": {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "TypeExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                }
                              }
                            ]
                          }
                        },
                        {
                          "Type": "VariableExpressionAst"
                        }
                      ]
                    }
                  },
                  {
                    "Type": "CommandAst",
                    "Command": "ForEach-Object {\n        if ($_.Extent -and $_.Extent.Text) {\n            $txt = $_.Extent.Text.Trim()\n            $txt = $txt -replace '^return\\s+', ''\n            $rets += $txt\n        }\n    }",
                    "Children": [
                      {
                        "Type": "StringConstantExpressionAst"
                      },
                      {
                        "Type": "ScriptBlockExpressionAst",
                        "Children": {
                          "Type": "ScriptBlockAst",
                          "Children": {
                            "Type": "NamedBlockAst",
                            "Children": {
                              "Type": "IfStatementAst",
                              "Condition": "$_.Extent -and $_.Extent.Text",
                              "Children": [
                                {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        },
                                        {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                },
                                {
                                  "Type": "StatementBlockAst",
                                  "Children": [
                                    {
                                      "Type": "AssignmentStatementAst",
                                      "Assignment": "$txt = $_.Extent.Text.Trim()",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "InvokeMemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "MemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "AssignmentStatementAst",
                                      "Assignment": "$txt = $txt -replace '^return\\s+', ''",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "BinaryExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "ArrayLiteralAst",
                                                "Children": [
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "AssignmentStatementAst",
                                      "Assignment": "$rets = $txt",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "VariableExpressionAst"
                                          }
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$rets | Sort-Object -Unique",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": [
                    {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "VariableExpressionAst"
                      }
                    },
                    {
                      "Type": "CommandAst",
                      "Command": "Sort-Object -Unique",
                      "Children": [
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "CommandParameterAst"
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:38.6989451Z",
    "Nombre": "Extract-ASTTree",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Extract-ASTTree",
    "Comandos": [
      "Extract-ASTTree",
      "ForEach-Object"
    ],
    "Returns": "$map",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$map = [ordered]@{\n        Type     = $Node.GetType().Name\n        Command   = $null\n        Assignment = $null\n        Condition = $null\n        Return    = $null\n        Children  = @()\n    }",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ConvertExpressionAst",
                      "Children": [
                        {
                          "Type": "TypeConstraintAst"
                        },
                        {
                          "Type": "HashtableAst",
                          "Children": [
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "InvokeMemberExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "VariableExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "VariableExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "VariableExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "VariableExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "ArrayExpressionAst",
                                  "Children": {
                                    "Type": "StatementBlockAst"
                                  }
                                }
                              }
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Management.Automation.Language.CommandAst]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "AssignmentStatementAst",
                        "Assignment": "$parts = $Node.CommandElements | ForEach-Object { $_.Extent.Text }",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "PipelineAst",
                            "Children": [
                              {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              },
                              {
                                "Type": "CommandAst",
                                "Command": "ForEach-Object { $_.Extent.Text }",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "ScriptBlockExpressionAst",
                                    "Children": {
                                      "Type": "ScriptBlockAst",
                                      "Children": {
                                        "Type": "NamedBlockAst",
                                        "Children": {
                                          "Type": "PipelineAst",
                                          "Children": {
                                            "Type": "CommandExpressionAst",
                                            "Children": {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "MemberExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "StringConstantExpressionAst"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "Type": "IfStatementAst",
                        "Condition": "$parts",
                        "Children": [
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandExpressionAst",
                              "Children": {
                                "Type": "VariableExpressionAst"
                              }
                            }
                          },
                          {
                            "Type": "StatementBlockAst",
                            "Children": {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$map[\"Command\"] = ($parts -join \" \")",
                              "Children": [
                                {
                                  "Type": "IndexExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "ParenExpressionAst",
                                    "Children": {
                                      "Type": "PipelineAst",
                                      "Children": {
                                        "Type": "CommandExpressionAst",
                                        "Children": {
                                          "Type": "BinaryExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Management.Automation.Language.AssignmentStatementAst]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "IfStatementAst",
                      "Condition": "$Node.Left -and $Node.Right",
                      "Children": [
                        {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "BinaryExpressionAst",
                              "Children": [
                                {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              ]
                            }
                          }
                        },
                        {
                          "Type": "StatementBlockAst",
                          "Children": [
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$lhs = $Node.Left.Extent.Text",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "MemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$rhs = $Node.Right.Extent.Text",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "MemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$map[\"Assignment\"] = \"$lhs = $rhs\"",
                              "Children": [
                                {
                                  "Type": "IndexExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "ExpandableStringExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "VariableExpressionAst"
                                      },
                                      {
                                        "Type": "VariableExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Management.Automation.Language.IfStatementAst]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "IfStatementAst",
                      "Condition": "$Node.Clauses.Count -gt 0",
                      "Children": [
                        {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "BinaryExpressionAst",
                              "Children": [
                                {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "MemberExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "ConstantExpressionAst"
                                }
                              ]
                            }
                          }
                        },
                        {
                          "Type": "StatementBlockAst",
                          "Children": [
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$cond = $Node.Clauses[0].Item1",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "IndexExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "ConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "IfStatementAst",
                              "Condition": "$cond -and $cond.Extent -and $cond.Extent.Text",
                              "Children": [
                                {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "BinaryExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                },
                                {
                                  "Type": "StatementBlockAst",
                                  "Children": {
                                    "Type": "AssignmentStatementAst",
                                    "Assignment": "$map[\"Condition\"] = $cond.Extent.Text.Trim()",
                                    "Children": [
                                      {
                                        "Type": "IndexExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "VariableExpressionAst"
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "CommandExpressionAst",
                                        "Children": {
                                          "Type": "InvokeMemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "MemberExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "StringConstantExpressionAst"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$Node -is [System.Management.Automation.Language.ReturnStatementAst]",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "TypeExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "IfStatementAst",
                      "Condition": "$Node.Extent -and $Node.Extent.Text",
                      "Children": [
                        {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "BinaryExpressionAst",
                              "Children": [
                                {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "MemberExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              ]
                            }
                          }
                        },
                        {
                          "Type": "StatementBlockAst",
                          "Children": [
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$txt = $Node.Extent.Text.Trim()",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "InvokeMemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "MemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$txt = $txt -replace '^return\\s+', ''",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "BinaryExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "VariableExpressionAst"
                                      },
                                      {
                                        "Type": "ArrayLiteralAst",
                                        "Children": [
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$map[\"Return\"] = $txt",
                              "Children": [
                                {
                                  "Type": "IndexExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$childrenAsts = $Node.FindAll({ param($n) $n.Parent -eq $Node }, $true)",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "InvokeMemberExpressionAst",
                      "Children": [
                        {
                          "Type": "VariableExpressionAst"
                        },
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "ScriptBlockExpressionAst",
                          "Children": {
                            "Type": "ScriptBlockAst",
                            "Children": [
                              {
                                "Type": "ParamBlockAst",
                                "Children": {
                                  "Type": "ParameterAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              },
                              {
                                "Type": "NamedBlockAst",
                                "Children": {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "BinaryExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        },
                                        {
                                          "Type": "VariableExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                }
                              }
                            ]
                          }
                        },
                        {
                          "Type": "VariableExpressionAst"
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "ForEachStatementAst",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "VariableExpressionAst"
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "AssignmentStatementAst",
                      "Assignment": "$map[\"Children\"] = Extract-ASTTree $ch",
                      "Children": [
                        {
                          "Type": "IndexExpressionAst",
                          "Children": [
                            {
                              "Type": "VariableExpressionAst"
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            }
                          ]
                        },
                        {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandAst",
                            "Command": "Extract-ASTTree $ch",
                            "Children": [
                              {
                                "Type": "StringConstantExpressionAst"
                              },
                              {
                                "Type": "VariableExpressionAst"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$map",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  }
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:39.5413374Z",
    "Nombre": "Extract-Params",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Extract-Params",
    "Returns": "$res",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$res = [ordered]@{}",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ConvertExpressionAst",
                      "Children": [
                        {
                          "Type": "TypeConstraintAst"
                        },
                        {
                          "Type": "HashtableAst"
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$AstNode.Parameters",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "MemberExpressionAst",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "StringConstantExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "ForEachStatementAst",
                      "Children": [
                        {
                          "Type": "VariableExpressionAst"
                        },
                        {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "MemberExpressionAst",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "StringConstantExpressionAst"
                                }
                              ]
                            }
                          }
                        },
                        {
                          "Type": "StatementBlockAst",
                          "Children": [
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$name = $p.Name.VariablePath.UserPath",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "MemberExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "MemberExpressionAst",
                                        "Children": [
                                          {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          }
                                        ]
                                      },
                                      {
                                        "Type": "StringConstantExpressionAst"
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$tp = if ($p.StaticType) { $p.StaticType.FullName } else { $null }",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "IfStatementAst",
                                  "Condition": "$p.StaticType",
                                  "Children": [
                                    {
                                      "Type": "PipelineAst",
                                      "Children": {
                                        "Type": "CommandExpressionAst",
                                        "Children": {
                                          "Type": "MemberExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "VariableExpressionAst"
                                            },
                                            {
                                              "Type": "StringConstantExpressionAst"
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    {
                                      "Type": "StatementBlockAst",
                                      "Children": {
                                        "Type": "PipelineAst",
                                        "Children": {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "VariableExpressionAst"
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    },
                                    {
                                      "Type": "StatementBlockAst",
                                      "Children": {
                                        "Type": "PipelineAst",
                                        "Children": {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "VariableExpressionAst"
                                          }
                                        }
                                      }
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$def = if ($p.DefaultValue -and $p.DefaultValue.Extent) { $p.DefaultValue.Extent.Text } else { $null }",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "IfStatementAst",
                                  "Condition": "$p.DefaultValue -and $p.DefaultValue.Extent",
                                  "Children": [
                                    {
                                      "Type": "PipelineAst",
                                      "Children": {
                                        "Type": "CommandExpressionAst",
                                        "Children": {
                                          "Type": "BinaryExpressionAst",
                                          "Children": [
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "VariableExpressionAst"
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            },
                                            {
                                              "Type": "MemberExpressionAst",
                                              "Children": [
                                                {
                                                  "Type": "MemberExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "StringConstantExpressionAst"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "Type": "StringConstantExpressionAst"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    {
                                      "Type": "StatementBlockAst",
                                      "Children": {
                                        "Type": "PipelineAst",
                                        "Children": {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "MemberExpressionAst",
                                                "Children": [
                                                  {
                                                    "Type": "MemberExpressionAst",
                                                    "Children": [
                                                      {
                                                        "Type": "VariableExpressionAst"
                                                      },
                                                      {
                                                        "Type": "StringConstantExpressionAst"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "Type": "StringConstantExpressionAst"
                                                  }
                                                ]
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    },
                                    {
                                      "Type": "StatementBlockAst",
                                      "Children": {
                                        "Type": "PipelineAst",
                                        "Children": {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "VariableExpressionAst"
                                          }
                                        }
                                      }
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$mand = $false",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "IfStatementAst",
                              "Condition": "$p.Attributes",
                              "Children": [
                                {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "MemberExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "VariableExpressionAst"
                                        },
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        }
                                      ]
                                    }
                                  }
                                },
                                {
                                  "Type": "StatementBlockAst",
                                  "Children": {
                                    "Type": "ForEachStatementAst",
                                    "Children": [
                                      {
                                        "Type": "VariableExpressionAst"
                                      },
                                      {
                                        "Type": "PipelineAst",
                                        "Children": {
                                          "Type": "CommandExpressionAst",
                                          "Children": {
                                            "Type": "MemberExpressionAst",
                                            "Children": [
                                              {
                                                "Type": "VariableExpressionAst"
                                              },
                                              {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      {
                                        "Type": "StatementBlockAst",
                                        "Children": {
                                          "Type": "IfStatementAst",
                                          "Condition": "$att.NamedArguments",
                                          "Children": [
                                            {
                                              "Type": "PipelineAst",
                                              "Children": {
                                                "Type": "CommandExpressionAst",
                                                "Children": {
                                                  "Type": "MemberExpressionAst",
                                                  "Children": [
                                                    {
                                                      "Type": "VariableExpressionAst"
                                                    },
                                                    {
                                                      "Type": "StringConstantExpressionAst"
                                                    }
                                                  ]
                                                }
                                              }
                                            },
                                            {
                                              "Type": "StatementBlockAst",
                                              "Children": {
                                                "Type": "ForEachStatementAst",
                                                "Children": [
                                                  {
                                                    "Type": "VariableExpressionAst"
                                                  },
                                                  {
                                                    "Type": "PipelineAst",
                                                    "Children": {
                                                      "Type": "CommandExpressionAst",
                                                      "Children": {
                                                        "Type": "MemberExpressionAst",
                                                        "Children": [
                                                          {
                                                            "Type": "VariableExpressionAst"
                                                          },
                                                          {
                                                            "Type": "StringConstantExpressionAst"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  {
                                                    "Type": "StatementBlockAst",
                                                    "Children": {
                                                      "Type": "IfStatementAst",
                                                      "Condition": "$arg.ArgumentName -eq \"Mandatory\"",
                                                      "Children": [
                                                        {
                                                          "Type": "PipelineAst",
                                                          "Children": {
                                                            "Type": "CommandExpressionAst",
                                                            "Children": {
                                                              "Type": "BinaryExpressionAst",
                                                              "Children": [
                                                                {
                                                                  "Type": "MemberExpressionAst",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "VariableExpressionAst"
                                                                    },
                                                                    {
                                                                      "Type": "StringConstantExpressionAst"
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "Type": "StringConstantExpressionAst"
                                                                }
                                                              ]
                                                            }
                                                          }
                                                        },
                                                        {
                                                          "Type": "StatementBlockAst",
                                                          "Children": {
                                                            "Type": "IfStatementAst",
                                                            "Condition": "$arg.Argument -and $arg.Argument.Extent.Text -match '^\\$true$'",
                                                            "Children": [
                                                              {
                                                                "Type": "PipelineAst",
                                                                "Children": {
                                                                  "Type": "CommandExpressionAst",
                                                                  "Children": {
                                                                    "Type": "BinaryExpressionAst",
                                                                    "Children": [
                                                                      {
                                                                        "Type": "MemberExpressionAst",
                                                                        "Children": [
                                                                          {
                                                                            "Type": "VariableExpressionAst"
                                                                          },
                                                                          {
                                                                            "Type": "StringConstantExpressionAst"
                                                                          }
                                                                        ]
                                                                      },
                                                                      {
                                                                        "Type": "BinaryExpressionAst",
                                                                        "Children": [
                                                                          {
                                                                            "Type": "MemberExpressionAst",
                                                                            "Children": [
                                                                              {
                                                                                "Type": "MemberExpressionAst",
                                                                                "Children": [
                                                                                  {
                                                                                    "Type": "MemberExpressionAst",
                                                                                    "Children": [
                                                                                      {
                                                                                        "Type": "VariableExpressionAst"
                                                                                      },
                                                                                      {
                                                                                        "Type": "StringConstantExpressionAst"
                                                                                      }
                                                                                    ]
                                                                                  },
                                                                                  {
                                                                                    "Type": "StringConstantExpressionAst"
                                                                                  }
                                                                                ]
                                                                              },
                                                                              {
                                                                                "Type": "StringConstantExpressionAst"
                                                                              }
                                                                            ]
                                                                          },
                                                                          {
                                                                            "Type": "StringConstantExpressionAst"
                                                                          }
                                                                        ]
                                                                      }
                                                                    ]
                                                                  }
                                                                }
                                                              },
                                                              {
                                                                "Type": "StatementBlockAst",
                                                                "Children": {
                                                                  "Type": "AssignmentStatementAst",
                                                                  "Assignment": "$mand = $true",
                                                                  "Children": [
                                                                    {
                                                                      "Type": "VariableExpressionAst"
                                                                    },
                                                                    {
                                                                      "Type": "CommandExpressionAst",
                                                                      "Children": {
                                                                        "Type": "VariableExpressionAst"
                                                                      }
                                                                    }
                                                                  ]
                                                                }
                                                              }
                                                            ]
                                                          }
                                                        }
                                                      ]
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  }
                                }
                              ]
                            },
                            {
                              "Type": "AssignmentStatementAst",
                              "Assignment": "$res[$name] = [ordered]@{\n                Tipo     = $tp\n                Default  = $def\n                Mandatory = $mand\n            }",
                              "Children": [
                                {
                                  "Type": "IndexExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "VariableExpressionAst"
                                    }
                                  ]
                                },
                                {
                                  "Type": "CommandExpressionAst",
                                  "Children": {
                                    "Type": "ConvertExpressionAst",
                                    "Children": [
                                      {
                                        "Type": "TypeConstraintAst"
                                      },
                                      {
                                        "Type": "HashtableAst",
                                        "Children": [
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          },
                                          {
                                            "Type": "PipelineAst",
                                            "Children": {
                                              "Type": "CommandExpressionAst",
                                              "Children": {
                                                "Type": "VariableExpressionAst"
                                              }
                                            }
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          },
                                          {
                                            "Type": "PipelineAst",
                                            "Children": {
                                              "Type": "CommandExpressionAst",
                                              "Children": {
                                                "Type": "VariableExpressionAst"
                                              }
                                            }
                                          },
                                          {
                                            "Type": "StringConstantExpressionAst"
                                          },
                                          {
                                            "Type": "PipelineAst",
                                            "Children": {
                                              "Type": "CommandExpressionAst",
                                              "Children": {
                                                "Type": "VariableExpressionAst"
                                              }
                                            }
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$res",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  }
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:39.9728355Z",
    "Nombre": "Convert-FunctionAstToRichSpec",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Convert-FunctionAstToRichSpec",
    "Comandos": [
      "Extract-ASTTree",
      "Extract-Commands",
      "Extract-Params",
      "Extract-Returns",
      "Extract-TryCatch",
      "Get-Date",
      "Remove-EmptyNodes"
    ],
    "Returns": "Remove-EmptyNodes $raw",
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": {
              "Type": "ParameterAst",
              "Children": [
                {
                  "Type": "TypeConstraintAst"
                },
                {
                  "Type": "VariableExpressionAst"
                }
              ]
            }
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$raw = [ordered]@{\n        schemaVersion   = \"2025.11.20.v1\"\n        generatedAt     = (Get-Date).ToUniversalTime().ToString(\"o\")\n        Nombre          = $Fn.Name\n        Lenguaje        = \"PowerShell\"\n        FirmaPowerShell = $Fn.Name\n        Parametros      = Extract-Params $Fn\n        Comandos        = Extract-Commands $Fn\n        TryCatch        = Extract-TryCatch $Fn\n        Returns         = Extract-Returns $Fn\n        AST             = Extract-ASTTree $Fn\n    }",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ConvertExpressionAst",
                      "Children": [
                        {
                          "Type": "TypeConstraintAst"
                        },
                        {
                          "Type": "HashtableAst",
                          "Children": [
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "StringConstantExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "InvokeMemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "InvokeMemberExpressionAst",
                                      "Children": [
                                        {
                                          "Type": "ParenExpressionAst",
                                          "Children": {
                                            "Type": "PipelineAst",
                                            "Children": {
                                              "Type": "CommandAst",
                                              "Command": "Get-Date",
                                              "Children": {
                                                "Type": "StringConstantExpressionAst"
                                              }
                                            }
                                          }
                                        },
                                        {
                                          "Type": "StringConstantExpressionAst"
                                        }
                                      ]
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "StringConstantExpressionAst"
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandExpressionAst",
                                "Children": {
                                  "Type": "MemberExpressionAst",
                                  "Children": [
                                    {
                                      "Type": "VariableExpressionAst"
                                    },
                                    {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandAst",
                                "Command": "Extract-Params $Fn",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "VariableExpressionAst"
                                  }
                                ]
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandAst",
                                "Command": "Extract-Commands $Fn",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "VariableExpressionAst"
                                  }
                                ]
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandAst",
                                "Command": "Extract-TryCatch $Fn",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "VariableExpressionAst"
                                  }
                                ]
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandAst",
                                "Command": "Extract-Returns $Fn",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "VariableExpressionAst"
                                  }
                                ]
                              }
                            },
                            {
                              "Type": "StringConstantExpressionAst"
                            },
                            {
                              "Type": "PipelineAst",
                              "Children": {
                                "Type": "CommandAst",
                                "Command": "Extract-ASTTree $Fn",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "VariableExpressionAst"
                                  }
                                ]
                              }
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "Remove-EmptyNodes $raw",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandAst",
                    "Command": "Remove-EmptyNodes $raw",
                    "Children": [
                      {
                        "Type": "StringConstantExpressionAst"
                      },
                      {
                        "Type": "VariableExpressionAst"
                      }
                    ]
                  }
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "schemaVersion": "2025.11.20.v1",
    "generatedAt": "2025-11-22T02:06:40.1510149Z",
    "Nombre": "Validate-And-WriteJson",
    "Lenguaje": "PowerShell",
    "FirmaPowerShell": "Validate-And-WriteJson",
    "Comandos": [
      "ConvertTo-Json",
      "Join-Path",
      "Out-File",
      "Test-Path"
    ],
    "Returns": [
      "$false",
      "$true"
    ],
    "AST": {
      "Type": "FunctionDefinitionAst",
      "Children": {
        "Type": "ScriptBlockAst",
        "Children": [
          {
            "Type": "ParamBlockAst",
            "Children": [
              {
                "Type": "ParameterAst",
                "Children": {
                  "Type": "VariableExpressionAst"
                }
              },
              {
                "Type": "ParameterAst",
                "Children": [
                  {
                    "Type": "TypeConstraintAst"
                  },
                  {
                    "Type": "VariableExpressionAst"
                  }
                ]
              },
              {
                "Type": "ParameterAst",
                "Children": [
                  {
                    "Type": "TypeConstraintAst"
                  },
                  {
                    "Type": "VariableExpressionAst"
                  }
                ]
              }
            ]
          },
          {
            "Type": "NamedBlockAst",
            "Children": [
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$safe = ($RawName -replace '[^A-Za-z0-9\\-_\\.]', '_')",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ParenExpressionAst",
                      "Children": {
                        "Type": "PipelineAst",
                        "Children": {
                          "Type": "CommandExpressionAst",
                          "Children": {
                            "Type": "BinaryExpressionAst",
                            "Children": [
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "ArrayLiteralAst",
                                "Children": [
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  },
                                  {
                                    "Type": "StringConstantExpressionAst"
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      }
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "$safe.Length -gt 120",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "MemberExpressionAst",
                            "Children": [
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "StringConstantExpressionAst"
                              }
                            ]
                          },
                          {
                            "Type": "ConstantExpressionAst"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": {
                      "Type": "AssignmentStatementAst",
                      "Assignment": "$safe = $safe.Substring(0,120)",
                      "Children": [
                        {
                          "Type": "VariableExpressionAst"
                        },
                        {
                          "Type": "CommandExpressionAst",
                          "Children": {
                            "Type": "InvokeMemberExpressionAst",
                            "Children": [
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "StringConstantExpressionAst"
                              },
                              {
                                "Type": "ConstantExpressionAst"
                              },
                              {
                                "Type": "ConstantExpressionAst"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$fname = \"$safe.json\"",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ExpandableStringExpressionAst",
                      "Children": {
                        "Type": "VariableExpressionAst"
                      }
                    }
                  }
                ]
              },
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$i = 1",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "ConstantExpressionAst"
                    }
                  }
                ]
              },
              {
                "Type": "WhileStatementAst",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandAst",
                      "Command": "Test-Path (Join-Path $OutDir $fname)",
                      "Children": [
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "ParenExpressionAst",
                          "Children": {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandAst",
                              "Command": "Join-Path $OutDir $fname",
                              "Children": [
                                {
                                  "Type": "StringConstantExpressionAst"
                                },
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "VariableExpressionAst"
                                }
                              ]
                            }
                          }
                        }
                      ]
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "AssignmentStatementAst",
                        "Assignment": "$fname = \"$safe-$i.json\"",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "ExpandableStringExpressionAst",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "VariableExpressionAst"
                                }
                              ]
                            }
                          }
                        ]
                      },
                      {
                        "Type": "PipelineAst",
                        "Children": {
                          "Type": "CommandExpressionAst",
                          "Children": {
                            "Type": "UnaryExpressionAst",
                            "Children": {
                              "Type": "VariableExpressionAst"
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$target = Join-Path $OutDir $fname",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandAst",
                      "Command": "Join-Path $OutDir $fname",
                      "Children": [
                        {
                          "Type": "StringConstantExpressionAst"
                        },
                        {
                          "Type": "VariableExpressionAst"
                        },
                        {
                          "Type": "VariableExpressionAst"
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "Type": "IfStatementAst",
                "Condition": "-not $Spec.schemaVersion -or -not $Spec.generatedAt",
                "Children": [
                  {
                    "Type": "PipelineAst",
                    "Children": {
                      "Type": "CommandExpressionAst",
                      "Children": {
                        "Type": "BinaryExpressionAst",
                        "Children": [
                          {
                            "Type": "UnaryExpressionAst",
                            "Children": {
                              "Type": "MemberExpressionAst",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "StringConstantExpressionAst"
                                }
                              ]
                            }
                          },
                          {
                            "Type": "UnaryExpressionAst",
                            "Children": {
                              "Type": "MemberExpressionAst",
                              "Children": [
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "StringConstantExpressionAst"
                                }
                              ]
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    "Type": "StatementBlockAst",
                    "Children": [
                      {
                        "Type": "AssignmentStatementAst",
                        "Assignment": "$errf = Join-Path $OutDir \"$safe.error.json\"",
                        "Children": [
                          {
                            "Type": "VariableExpressionAst"
                          },
                          {
                            "Type": "PipelineAst",
                            "Children": {
                              "Type": "CommandAst",
                              "Command": "Join-Path $OutDir \"$safe.error.json\"",
                              "Children": [
                                {
                                  "Type": "StringConstantExpressionAst"
                                },
                                {
                                  "Type": "VariableExpressionAst"
                                },
                                {
                                  "Type": "ExpandableStringExpressionAst",
                                  "Children": {
                                    "Type": "VariableExpressionAst"
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      },
                      {
                        "Type": "PipelineAst",
                        "Children": [
                          {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "HashtableAst",
                              "Children": [
                                {
                                  "Type": "StringConstantExpressionAst"
                                },
                                {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "StringConstantExpressionAst"
                                    }
                                  }
                                },
                                {
                                  "Type": "StringConstantExpressionAst"
                                },
                                {
                                  "Type": "PipelineAst",
                                  "Children": {
                                    "Type": "CommandExpressionAst",
                                    "Children": {
                                      "Type": "VariableExpressionAst"
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          {
                            "Type": "CommandAst",
                            "Command": "ConvertTo-Json -Depth 50 -EscapeHandling EscapeNonAscii",
                            "Children": [
                              {
                                "Type": "StringConstantExpressionAst"
                              },
                              {
                                "Type": "CommandParameterAst"
                              },
                              {
                                "Type": "ConstantExpressionAst"
                              },
                              {
                                "Type": "CommandParameterAst"
                              },
                              {
                                "Type": "StringConstantExpressionAst"
                              }
                            ]
                          },
                          {
                            "Type": "CommandAst",
                            "Command": "Out-File -LiteralPath $errf -Encoding utf8",
                            "Children": [
                              {
                                "Type": "StringConstantExpressionAst"
                              },
                              {
                                "Type": "CommandParameterAst"
                              },
                              {
                                "Type": "VariableExpressionAst"
                              },
                              {
                                "Type": "CommandParameterAst"
                              },
                              {
                                "Type": "StringConstantExpressionAst"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "Type": "ReturnStatementAst",
                        "Return": "$false",
                        "Children": {
                          "Type": "PipelineAst",
                          "Children": {
                            "Type": "CommandExpressionAst",
                            "Children": {
                              "Type": "VariableExpressionAst"
                            }
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "AssignmentStatementAst",
                "Assignment": "$json = $Spec | ConvertTo-Json -Depth 50 -EscapeHandling EscapeNonAscii",
                "Children": [
                  {
                    "Type": "VariableExpressionAst"
                  },
                  {
                    "Type": "PipelineAst",
                    "Children": [
                      {
                        "Type": "CommandExpressionAst",
                        "Children": {
                          "Type": "VariableExpressionAst"
                        }
                      },
                      {
                        "Type": "CommandAst",
                        "Command": "ConvertTo-Json -Depth 50 -EscapeHandling EscapeNonAscii",
                        "Children": [
                          {
                            "Type": "StringConstantExpressionAst"
                          },
                          {
                            "Type": "CommandParameterAst"
                          },
                          {
                            "Type": "ConstantExpressionAst"
                          },
                          {
                            "Type": "CommandParameterAst"
                          },
                          {
                            "Type": "StringConstantExpressionAst"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "PipelineAst",
                "Children": [
                  {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  },
                  {
                    "Type": "CommandAst",
                    "Command": "Out-File -LiteralPath $target -Encoding utf8",
                    "Children": [
                      {
                        "Type": "StringConstantExpressionAst"
                      },
                      {
                        "Type": "CommandParameterAst"
                      },
                      {
                        "Type": "VariableExpressionAst"
                      },
                      {
                        "Type": "CommandParameterAst"
                      },
                      {
                        "Type": "StringConstantExpressionAst"
                      }
                    ]
                  }
                ]
              },
              {
                "Type": "ReturnStatementAst",
                "Return": "$true",
                "Children": {
                  "Type": "PipelineAst",
                  "Children": {
                    "Type": "CommandExpressionAst",
                    "Children": {
                      "Type": "VariableExpressionAst"
                    }
                  }
                }
              }
            ]
          }
        ]
      }
    }
  }
]
